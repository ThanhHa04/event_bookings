<!-- includes/ticket_modal.php -->
<?php if (isset($selectedEvent) && isset($seats)): ?>
<div class="modal fade show" id="ticketModal" tabindex="-1" style="display: block;" aria-modal="true" role="dialog">
  <div class="modal-dialog modal-xl modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title"><i class="bi bi-ticket-perforated"></i> Chi tiết vé & sơ đồ ghế</h5>
        <a href="events.php?status=<?= $status ?>" class="btn-close"></a>
      </div>
      <div class="modal-body row g-4">
        <!-- Thông tin sự kiện -->
        <div class="col-md-4">
          <img src="../assets/images/<?= htmlspecialchars($selectedEvent['event_img']) ?>" class="img-fluid rounded mb-3">
          <h5><?= htmlspecialchars($selectedEvent['event_name']) ?></h5>
          <p><i class="bi bi-clock"></i> <?= date('H:i d/m/Y', strtotime($selectedEvent['start_time'])) ?></p>
          <p><i class="bi bi-geo-alt"></i> <?= htmlspecialchars($selectedEvent['location']) ?></p>
          <p><i class="bi bi-cash-coin"></i> Giá vé: <?= number_format($selectedEvent['price']) ?> đ</p>
          <p><i class="bi bi-person-lines-fill"></i> Còn trống: 
            <?= count(array_filter($seats, fn($s) => $s['sStatus'] === 'Còn trống')) ?> / <?= count($seats) ?>
          </p>
        </div>

        <!-- Sơ đồ ghế -->
        <div class="col-md-8">
          <div class="border p-3 rounded d-flex flex-wrap" style="min-height: 250px;">
            <?php
              $i = 0;
              foreach ($seats as $seat):
                  $class = $seat['sStatus'] === 'Còn trống' ? 'available' : 'booked';
                  echo "<div class='seat $class'>{$seat['seat_id']}</div>";
                  $i++;
                  if ($i % 10 === 0) echo '<div class="w-100"></div>';
              endforeach;
            ?>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<style>
.seat {
    width: 45px;
    height: 45px;
    margin: 5px;
    border-radius: 10px;
    text-align: center;
    line-height: 45px;
    font-weight: bold;
    color: white;
}
.seat.available {
    background-color: #198754;
}
.seat.booked {
    background-color: #d63384;
}
</style>
<?php endif ?>
